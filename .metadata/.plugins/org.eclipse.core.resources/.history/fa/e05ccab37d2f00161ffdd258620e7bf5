<%@ page language="java" contentType="text/html; charset=EUC-KR"
    pageEncoding="EUC-KR"%>
<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<%@ page import = "java.sql.*" %>
<%!
Connection con = null; 
Statement st = null; 
ResultSet rs = null;
String nextURL = "";
%>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=EUC-KR">
<title></title>
</head>
<body>
<% 

try
{
	String id = request.getParameter("id");
	String pw = request.getParameter("pw");
	
		Class.forName("com.mysql.jdbc.Driver");
		con = DriverManager.getConnection("jdbc:mysql://localhost/ucampus", "root", "1234");
		out.println("sql err");
	if(con == null)
		out.println("Mang.....");
	

		st = con.createStatement();
		rs = st.executeQuery("select Is_student from user where ID = " + id + " AND PW = " + pw);
	
	if(rs.next())
	{
		if(rs.getInt(1) == 0)
		{
			nextURL = "MainProfessor.jsp";
			
		}
		else if(rs.getInt(1) == 1)
		{
			nextURL = "MainStudent.jsp";
		}
	}
	else
	{
		out.println("<script>alert('failed...');</script>");
	}
	
	if(nextURL.equals(""))
	{
		out.println("<script>alert('failed...');</script>");
	}
}
catch(Exception e){
	nextURL = "LoginFailed.html";
}
%>

<%-- <script type="text/javascript">
         location.href="<%=nextURL%>"; --%>
		    </script>
		      <form action="<%=nextURL%>">
		      <h1>로그인되었습니다</h1>
		      <input type="submit" name="id" title="확인" value="<%=id%>"/>
		      </form>


</body>
</html>